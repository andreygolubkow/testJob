SELECT M.name||Y.year as `Period`,[Product].name as `Product`,(SELECT maxAmount FROM (SELECT [Order].product_id,SUM([Order].amount) as `maxAmount` FROM [Order] WHERE strftime('%m',date([Order].dt, 'unixepoch')) = [M].id AND strftime('%Y',date([Order].dt, 'unixepoch')) = CAST([Y].year as string)  GROUP BY [Order].product_id ORDER BY maxAmount DESC LIMIT 1)) as `Sum`,  ROUND(((SELECT maxAmount FROM (SELECT [Order].product_id,SUM([Order].amount) as `maxAmount` FROM [Order] WHERE strftime('%m',date([Order].dt, 'unixepoch')) = [M].id AND strftime('%Y',date([Order].dt, 'unixepoch')) = CAST([Y].year as string)  GROUP BY [Order].product_id ORDER BY maxAmount DESC LIMIT 1)))/   (SELECT SUM([Order].amount) as `sum` FROM [Order] WHERE strftime('%m',date([Order].dt, 'unixepoch')) = [M].id AND strftime('%Y',date([Order].dt, 'unixepoch')) = CAST([Y].year as string) )  *100,0) as `Part` FROM  (SELECT strftime(' %Y', date([Order].dt, 'unixepoch')) as year FROM [Order] GROUP BY year) as [Y], [Month] as [M], [Product] WHERE  NOT([maxProducts] is NULL) AND [Product].id =  (SELECT product_id FROM (SELECT [Order].product_id,SUM([Order].amount) as `maxAmount` FROM [Order] WHERE strftime('%m',date([Order].dt, 'unixepoch')) = [M].id AND strftime('%Y',date([Order].dt, 'unixepoch')) = CAST([Y].year as string)  GROUP BY [Order].product_id ORDER BY maxAmount DESC LIMIT 1))
